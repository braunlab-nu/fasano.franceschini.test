<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fasano-Franceschini Test — fasano.franceschini.test • fasano.franceschini.test</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fasano-Franceschini Test — fasano.franceschini.test"><meta property="og:description" content="Performs a multidimensional two-sample Kolmogorov-Smirnov test as described by Fasano and Franceschini (1987).
This test evaluates the null hypothesis that two i.i.d. random samples were drawn from the same underlying
probability distribution. The data can be of any dimension, and can be of any type (continuous, discrete, or mixed)."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fasano.franceschini.test</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fasano-Franceschini Test</h1>
    
    <div class="hidden name"><code>fasano.franceschini.test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs a multidimensional two-sample Kolmogorov-Smirnov test as described by Fasano and Franceschini (1987).
This test evaluates the null hypothesis that two i.i.d. random samples were drawn from the same underlying
probability distribution. The data can be of any dimension, and can be of any type (continuous, discrete, or mixed).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">fasano.franceschini.test</span><span class="op">(</span>
  <span class="va">S1</span>,
  <span class="va">S2</span>,
  nPermute <span class="op">=</span> <span class="fl">100</span>,
  threads <span class="op">=</span> <span class="fl">1</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  seed <span class="op">=</span> <span class="cn">NULL</span>,
  p.conf.level <span class="op">=</span> <span class="fl">0.95</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>S1</dt>
<dd><p><code>matrix</code> or <code>data.frame</code>.</p></dd>
<dt>S2</dt>
<dd><p><code>matrix</code> or <code>data.frame</code>.</p></dd>
<dt>nPermute</dt>
<dd><p>a nonnegative <code>integer</code> setting the number of permuted samples to generate
when estimating the permutation test p-value. Default is 100. If set to 0, no p-value is estimated.</p></dd>
<dt>threads</dt>
<dd><p>a positive <code>integer</code> or <code>"auto"</code> setting the number of threads used for performing
the permutation test. If set to <code>"auto"</code>, the number of threads is determined by
<code><a href="https://rdrr.io/pkg/RcppParallel/man/setThreadOptions.html" class="external-link">RcppParallel::defaultNumThreads()</a></code>. Default is 1.</p></dd>
<dt>verbose</dt>
<dd><p>a <code>boolean</code> indicating whether to display a progress bar. Default is <code>FALSE</code>. Only available for serial
version (<code>threads</code> = 1).</p></dd>
<dt>seed</dt>
<dd><p>optional integer to seed the PRNG used for the permutation test. Default is <code>NULL</code>. Only available for serial
version (<code>threads</code> = 1).</p></dd>
<dt>p.conf.level</dt>
<dd><p>confidence level for the confidence interval of the permutation test p-value.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with class <code>htest</code> containing the following components:</p>
<dl><dt>statistic</dt>
<dd><p>the value of the test statistic Z.</p></dd>
<dt>estimate</dt>
<dd><p>the value of the difference statistics D1 and D2.</p></dd>
<dt>p.value</dt>
<dd><p>the permutation test p-value.</p></dd>
<dt>conf.int</dt>
<dd><p>a binomial confidence interval for the p-value.</p></dd>
<dt>method</dt>
<dd><p>a character string indicating what type of test was performed.</p></dd>
<dt>data.name</dt>
<dd><p>a character string giving the names of the data.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The test statistic is computed using an efficient range tree implementation with a time complexity of <em>O(n*log(n)^(d-1))</em>,
where <em>n</em> is the size of the largest sample and <em>d</em> is the dimension of the data.</p>
<p>The p-value for the test is computed empirically using a permutation test. As it is almost always infeasible to compute the exact permutation
test p-value, a Monte Carlo approximation is made instead. This estimate is a binomially distributed random variable, and thus a confidence
interval can be computed. The confidence interval is obtained using the procedure given in Clopper and Pearson (1934).</p>
<p>Since p-values are calculated using a permutation test, the data can be of any dimensionality and of any type (continuous, discrete, or mixed).
If there are ties in the data, points are counted with multiplicity.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p></p><ul><li><p>Fasano, G. &amp; Franceschini, A. (1987). A multidimensional version of the Kolmogorov-Smirnov test. <em>Monthly Notices of the Royal Astronomical Society</em>, 225:155-170. <a href="https://doi.org/10.1093/mnras/225.1.155" class="external-link">doi:10.1093/mnras/225.1.155</a>
.</p></li>
<li><p>Clopper, C. J. &amp; Pearson, E. S. (1934). The use of confidence or fiducial limits illustrated in the case of the binomial. <em>Biometrika</em>, 26, 404–413. <a href="https://doi.org/10.2307/2331986" class="external-link">doi:10.2307/2331986</a>
.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># create 2-D samples using data frames</span></span>
<span class="r-in"><span class="va">S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">150</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">150</span>, mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># perform test (serial version)</span></span>
<span class="r-in"><span class="fu">fasano.franceschini.test</span><span class="op">(</span><span class="va">S1</span>, <span class="va">S2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fasano-Francheschini Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  S1 and S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z = 0.87773, p-value = 0.7624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.6673737 0.8414316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        D1        D2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1333333 0.1533333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># perform test with more permutations</span></span>
<span class="r-in"><span class="fu">fasano.franceschini.test</span><span class="op">(</span><span class="va">S1</span>, <span class="va">S2</span>, nPermute <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fasano-Francheschini Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  S1 and S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z = 0.87773, p-value = 0.8259</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7662415 0.8756142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        D1        D2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1333333 0.1533333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># set seed for reproducible p-value</span></span>
<span class="r-in"><span class="fu">fasano.franceschini.test</span><span class="op">(</span><span class="va">S1</span>, <span class="va">S2</span>, seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fasano-Francheschini Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  S1 and S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z = 0.87773, p-value = 0.8911</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.8134799 0.9443628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        D1        D2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1333333 0.1533333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># display progress bar</span></span>
<span class="r-in"><span class="fu">fasano.franceschini.test</span><span class="op">(</span><span class="va">S1</span>, <span class="va">S2</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fasano-Francheschini Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  S1 and S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z = 0.87773, p-value = 0.8713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7899580 0.9296498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        D1        D2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1333333 0.1533333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># change confidence level for p-value confidence interval</span></span>
<span class="r-in"><span class="fu">fasano.franceschini.test</span><span class="op">(</span><span class="va">S1</span>, <span class="va">S2</span>, p.conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fasano-Francheschini Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  S1 and S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z = 0.87773, p-value = 0.7426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.6157451 0.8457810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        D1        D2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1333333 0.1533333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># perform test (parallel version, 2 threads)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="fu">fasano.franceschini.test</span><span class="op">(</span><span class="va">S1</span>, <span class="va">S2</span>, threads <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># create 3-D mixed samples using matrices</span></span>
<span class="r-in"><span class="va">S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">43</span>, shape <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">            <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">43</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">            <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">43</span>, lambda <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">72</span>, shape <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">            <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">72</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">            <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">72</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># perform test</span></span>
<span class="r-in"><span class="fu">fasano.franceschini.test</span><span class="op">(</span><span class="va">S1</span>, <span class="va">S2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fasano-Francheschini Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  S1 and S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z = 1.8443, p-value = 0.009901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.00025064 0.05393235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        D1        D2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3323643 0.3785530 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Connor Puritz, Elan Ness-Cohn.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

